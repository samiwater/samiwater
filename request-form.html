document.getElementById("request-form").addEventListener("submit", function (e) {
  e.preventDefault();

  const form = e.target;
  const data = new URLSearchParams(new FormData(form));

  document.getElementById("msg").innerHTML = "⏳ در حال ارسال اطلاعات ...";

  fetch("https://script.google.com/macros/s/AKfycbz4hjQpslhBOi9XUmqnjp7y5x_umnQE-BhztWgI1KKhX1KMsOw0mZ2MDSFyhatTEMd8/exec", {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: data
  })
    .then(res => res.text())
    .then(txt => {
      document.getElementById("msg").innerHTML = "✅ ثبت شد: " + txt;
      form.reset();
      setTimeout(() => {
        window.location.href = "request-confirmed.html";
      }, 3000);
    })
    .catch(err => {
      document.getElementById("msg").innerHTML = "❌ خطا در ارسال اطلاعات. لطفاً دوباره تلاش کنید.<br>" + err;
      console.error(err);
    });
});
